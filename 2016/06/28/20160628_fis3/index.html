<!DOCTYPE html><html lang=""><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 使用fis3自动构建前端项目快速上手 · wah's life</title><meta name="description" content="使用fis3自动构建前端项目快速上手 - 石华"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://shiwah.me/atom.xml" title="wah's life"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/author.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="http://weibo.com/shihuacivis" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="http://shihuacivis.lofter.com" target="_blank" class="nav-list-link">LOFTER</a></li><li class="nav-list-item"><a href="https://github.com/shihuacivis" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">使用fis3自动构建前端项目快速上手</h1><div class="post-info">Jun 28, 2016</div><div class="post-content"><p>fis3配置快速开始指南，实现编译SASS(SCSS)，压缩JS、CSS、图片，PC端合雪碧图，移动端自动转换REM值，开发时浏览器自动同步的功能，一份代码编译适应多个环境等功能，满足日产活动项目的需求。<br><a id="more"></a></p>
<h3 id="1-安装node-js环境"><a href="#1-安装node-js环境" class="headerlink" title="1. 安装node.js环境"></a>1. 安装node.js环境</h3><h3 id="2-由于npm网速不理想，-建议安装cnpm，-详细方法：https-npm-taobao-org"><a href="#2-由于npm网速不理想，-建议安装cnpm，-详细方法：https-npm-taobao-org" class="headerlink" title="2. 由于npm网速不理想， 建议安装cnpm， 详细方法：https://npm.taobao.org/"></a>2. 由于npm网速不理想， 建议安装cnpm， 详细方法：<a href="https://npm.taobao.org/" target="_blank" rel="external">https://npm.taobao.org/</a></h3><blockquote>
<p>a.打开命令行（开始菜单搜索cmd）, 输入：<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</div></pre></td></tr></table></figure></p>
<p>b.安装完成后以后npm的指令可以用cnpm代替执行</p>
</blockquote>
<h3 id="3-安装fis3，安装方法：-http-fis-baidu-com-fis3-docs-beginning-install-html"><a href="#3-安装fis3，安装方法：-http-fis-baidu-com-fis3-docs-beginning-install-html" class="headerlink" title="3. 安装fis3，安装方法： http://fis.baidu.com/fis3/docs/beginning/install.html"></a>3. 安装fis3，安装方法： <a href="http://fis.baidu.com/fis3/docs/beginning/install.html" target="_blank" rel="external">http://fis.baidu.com/fis3/docs/beginning/install.html</a></h3><blockquote>
<p>a. 安装fis3环境， 命令行执行：<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cnpm install -g fis3</div></pre></td></tr></table></figure></p>
<p>b. 由于fis3抽风般的默认使用绝对路径，所以需要安装相对路径插件fis3-hook-relative，命令行执行：<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cnpm install -g fis3-hook-relative</div></pre></td></tr></table></figure></p>
<p>c. 选装sass/less编译环境，推荐使用sass环境，命令行执行：<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cnpm install -g fis-parser-node-sass</div></pre></td></tr></table></figure></p>
<p>d. 安装px2rem插件，以后在css文件中只需要按设计稿上的px值1:1编码。命令行执行：<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cnpm install -g fis-postprocessor-px2rem</div></pre></td></tr></table></figure></p>
<p>e. 安装文件合并插件，命令行执行：<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cnpm install -g fis3-postpackager-loader</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="4-fis-conf-js配置"><a href="#4-fis-conf-js配置" class="headerlink" title="4. fis-conf.js配置"></a>4. fis-conf.js配置</h3><p>项目一般我们的项目分为pc端和移动端两种，因此fis分两种配置，在PC端上，当我们打包正式包时，会自动合成雪碧图，而在移动端上则不会合图，但会自动将css的px转成rem以实现自适应布局。若有特殊项目则可以自行修改配置文件fis-conf.js。</p>
<ul>
<li><p>PC端fis-conf.js配置<br>目前发现雪碧图插件和文件合并插件不能同时使用，所有选择开启优化效果更明显的雪碧图插件，暂时放弃文件自动合并插件。<br>包含以下功能：编译SASS(SCSS)，压缩JS、CSS、图片，合雪碧图。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// PC端项目 通用配置</span></div><div class="line"><span class="comment">// 测试包配置 执行 fis3 release test</span></div><div class="line"><span class="keyword">var</span> TEST_OUTPUT_PATH = <span class="string">'./test'</span>; <span class="comment">// 测试包路径 （仅执行编译，不压缩）</span></div><div class="line"><span class="keyword">var</span> TEST_USE_HASH = <span class="literal">false</span>; <span class="comment">// 是否使用文件指纹 （随机改变文件名避免浏览器缓存）</span></div><div class="line"></div><div class="line"><span class="comment">// 正式包配置 执行 fis3 release dist</span></div><div class="line"><span class="keyword">var</span> FORMAL_OUTPUT_PATH = <span class="string">'./dist'</span>; <span class="comment">// 正式打包路径（包含编译、压缩代码 、图片压缩、csssprite）</span></div><div class="line"><span class="keyword">var</span> FORMAL_USE_HASH = <span class="literal">false</span>; <span class="comment">// 是否使用文件指纹 （随机改变文件名避免浏览器缓存）</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 常规设置 基本不用动</span></div><div class="line">fis.set(<span class="string">'project.files'</span>, [<span class="string">'src/**'</span>]);</div><div class="line">fis.set(<span class="string">'project.ignore'</span>, [<span class="string">'node_modules/**'</span>, <span class="string">'dist/**'</span>, <span class="string">'README.md'</span> , <span class="string">'local/**'</span> , <span class="string">'.git/**'</span>, <span class="string">'fis-conf.js'</span>]);</div><div class="line">fis.set(<span class="string">'charset'</span>, <span class="string">'utf-8'</span>);</div><div class="line">fis.set(<span class="string">'project.charset'</span>, <span class="string">'utf-8'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// less 编译插件 fis-parser-less</span></div><div class="line"><span class="comment">// fis.match('**.less', &#123;</span></div><div class="line"><span class="comment">//     parser: fis.plugin('less'),</span></div><div class="line"><span class="comment">//     rExt: '.css'</span></div><div class="line"><span class="comment">// &#125;);</span></div><div class="line"><span class="comment">// fis.match(/^\/src\/c\/_.*\.(css|less)/i,&#123;</span></div><div class="line"><span class="comment">//   release : false</span></div><div class="line"><span class="comment">// &#125;);</span></div><div class="line"></div><div class="line"><span class="comment">// sass 编译插件 fis-parser-node-sass</span></div><div class="line">fis.match(<span class="string">'*.scss'</span>, &#123;</div><div class="line">  <span class="attr">rExt</span>: <span class="string">'.css'</span>,</div><div class="line">  <span class="attr">parser</span>: fis.plugin(<span class="string">'node-sass'</span>)</div><div class="line">&#125;);</div><div class="line">fis.match(<span class="regexp">/^\/src\/css\/_.*\.(css|scss)/i</span>,&#123;</div><div class="line">    <span class="attr">release</span> : <span class="literal">false</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">fis.match(<span class="regexp">/^\/src\/(.*)$/i</span>,&#123;</div><div class="line">  <span class="attr">release</span> : <span class="string">"$1"</span>,</div><div class="line">  <span class="attr">useCache</span> : <span class="literal">false</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 使用相对路径</span></div><div class="line">fis.hook(<span class="string">'relative'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 配置测试打包 不压缩代码 不合图不压缩</span></div><div class="line">fis.media(<span class="string">'test'</span>)</div><div class="line">  .match(<span class="string">'**'</span>, &#123;</div><div class="line">    <span class="attr">relative</span>: <span class="literal">true</span></div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.&#123;js,css,scss,png,jpg,jpeg,gif,mp3,mp4,flv,swf,svg,eot,ttf,woff&#125;'</span>,&#123;</div><div class="line">      <span class="attr">useHash</span>: TEST_USE_HASH</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**'</span>, &#123;</div><div class="line">    <span class="attr">deploy</span>: fis.plugin(<span class="string">'local-deliver'</span>, &#123;</div><div class="line">        <span class="attr">to</span>: TEST_OUTPUT_PATH</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 配置正式打包 包含压缩代码 合图图压缩</span></div><div class="line">fis.media(<span class="string">'dist'</span>)</div><div class="line">  .match(<span class="string">'**'</span>, &#123;</div><div class="line">    <span class="attr">relative</span>: <span class="literal">true</span></div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.&#123;js,css,scss,png,jpg,jpeg,gif,mp3,mp4,flv,swf,svg,eot,ttf,woff&#125;'</span>,&#123;</div><div class="line">      <span class="attr">useHash</span>: FORMAL_USE_HASH</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**.js'</span>,&#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'uglify-js'</span>,&#123;</div><div class="line">      <span class="attr">output</span> : &#123;</div><div class="line">        <span class="attr">ascii_only</span> : <span class="literal">true</span></div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**.html:js'</span>,&#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'uglify-js'</span>)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="regexp">/^\/src\/c\/(.*\.png)$/i</span>,&#123;</div><div class="line">    <span class="attr">release</span> : <span class="string">"i/spriter/$1"</span></div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.png'</span>, &#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'png-compressor'</span>)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.&#123;css,scss&#125;'</span>,&#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'clean-css'</span>)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**html:css'</span>,&#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'clean-css'</span>)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'::package'</span>, &#123;</div><div class="line">    <span class="attr">spriter</span>: fis.plugin(<span class="string">'csssprites'</span>,&#123;</div><div class="line">      <span class="attr">layout</span>: <span class="string">'matrix'</span>,</div><div class="line">      <span class="attr">margin</span>: <span class="string">'0'</span></div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">  <span class="comment">// .match('::package', &#123;</span></div><div class="line">  <span class="comment">//   postpackager: fis.plugin('loader', &#123;</span></div><div class="line">  <span class="comment">//     allInOne: &#123;</span></div><div class="line">  <span class="comment">//       js: 'j/auto_aio.js',</span></div><div class="line">  <span class="comment">//       css: 'c/auto_aio.css'</span></div><div class="line">  <span class="comment">//     &#125;</span></div><div class="line">  <span class="comment">//   &#125;)</span></div><div class="line">  <span class="comment">// &#125;)</span></div><div class="line">  .match(<span class="string">'*.&#123;css,scss&#125;'</span>,&#123;</div><div class="line">    <span class="attr">useSprite</span> : <span class="literal">true</span></div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**'</span>, &#123;</div><div class="line">    <span class="attr">deploy</span>: fis.plugin(<span class="string">'local-deliver'</span>, &#123;</div><div class="line">      <span class="attr">to</span>: FORMAL_OUTPUT_PATH</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>移动端fis-conf.js配置<br>包含以下功能：编译SASS(SCSS)，自动将px单位转为REM单位，压缩JS、CSS、图片，合并JS/CSS文件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 移动端项目 通用配置</span></div><div class="line"><span class="comment">// 测试包配置 执行 fis3 release test</span></div><div class="line"><span class="keyword">var</span> TEST_OUTPUT_PATH = <span class="string">'./test'</span>; <span class="comment">// 测试包路径 （仅执行编译，不压缩）</span></div><div class="line"><span class="keyword">var</span> TEST_USE_HASH = <span class="literal">false</span>; <span class="comment">// 是否使用文件指纹 （随机改变文件名避免浏览器缓存）</span></div><div class="line"></div><div class="line"><span class="comment">// 正式包配置 执行 fis3 release dist</span></div><div class="line"><span class="keyword">var</span> FORMAL_OUTPUT_PATH = <span class="string">'./dist'</span>; <span class="comment">// 正式打包路径（包含编译、压缩代码 、图片压缩、csssprite）</span></div><div class="line"><span class="keyword">var</span> FORMAL_USE_HASH = <span class="literal">false</span>; <span class="comment">// 是否使用文件指纹 （随机改变文件名避免浏览器缓存）</span></div><div class="line"></div><div class="line"><span class="comment">// 移动端自适应配置</span></div><div class="line"><span class="keyword">var</span> REM_UNIT = <span class="number">100</span>; <span class="comment">// rem的基础单位</span></div><div class="line"><span class="keyword">var</span> BASE_DPR = <span class="number">1</span>; <span class="comment">// 通用设备时一般为1</span></div><div class="line"></div><div class="line"><span class="comment">// 常规设置 基本不用动</span></div><div class="line">fis.set(<span class="string">'project.files'</span>, [<span class="string">'src/**'</span>]);</div><div class="line">fis.set(<span class="string">'project.ignore'</span>, [<span class="string">'node_modules/**'</span>, <span class="string">'dist/**'</span>, <span class="string">'README.md'</span> , <span class="string">'local/**'</span> , <span class="string">'.git/**'</span>, <span class="string">'fis-conf.js'</span>]);</div><div class="line">fis.set(<span class="string">'charset'</span>, <span class="string">'utf-8'</span>);</div><div class="line">fis.set(<span class="string">'project.charset'</span>, <span class="string">'utf-8'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// less 编译插件 fis-parser-less</span></div><div class="line"><span class="comment">// fis.match('**.less', &#123;</span></div><div class="line"><span class="comment">//     parser: fis.plugin('less'),</span></div><div class="line"><span class="comment">//     rExt: '.css'</span></div><div class="line"><span class="comment">// &#125;);</span></div><div class="line"><span class="comment">// fis.match(/^\/src\/c\/_.*\.(css|less)/i,&#123;</span></div><div class="line"><span class="comment">//   release : false</span></div><div class="line"><span class="comment">// &#125;);</span></div><div class="line"></div><div class="line"><span class="comment">// sass 编译插件 fis-parser-node-sass</span></div><div class="line">fis.match(<span class="string">'*.scss'</span>, &#123;</div><div class="line">  <span class="attr">rExt</span>: <span class="string">'.css'</span>,</div><div class="line">  <span class="attr">parser</span>: fis.plugin(<span class="string">'node-sass'</span>)</div><div class="line">&#125;);</div><div class="line"></div><div class="line">fis.match(<span class="regexp">/^\/src\/(.*)$/i</span>,&#123;</div><div class="line">  <span class="attr">release</span> : <span class="string">"$1"</span>,</div><div class="line">  <span class="attr">useCache</span> : <span class="literal">false</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">fis.match(<span class="string">'*.&#123;css,scss&#125;'</span>, &#123;</div><div class="line">    <span class="attr">postprocessor</span>: fis.plugin(<span class="string">'px2rem'</span>, &#123;</div><div class="line">      <span class="attr">baseDpr</span>: BASE_DPR,             <span class="comment">// base device pixel ratio (default: 2)</span></div><div class="line">      remVersion: <span class="literal">true</span>,       <span class="comment">// whether to generate rem version (default: true)</span></div><div class="line">      remUnit: REM_UNIT,            <span class="comment">// rem unit value (default: 75)</span></div><div class="line">      remPrecision: <span class="number">6</span>         <span class="comment">// rem precision (default: 6)</span></div><div class="line">    &#125;)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 使用相对路径</span></div><div class="line">fis.hook(<span class="string">'relative'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 配置测试打包 不压缩代码 不合图不压缩</span></div><div class="line">fis.media(<span class="string">'test'</span>)</div><div class="line">  .match(<span class="string">'**'</span>, &#123;</div><div class="line">    <span class="attr">relative</span>: <span class="literal">true</span></div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.&#123;js,css,scss,png,jpg,jpeg,gif,mp3,mp4,flv,swf,svg,eot,ttf,woff&#125;'</span>,&#123;</div><div class="line">      <span class="attr">useHash</span>: TEST_USE_HASH</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**'</span>, &#123;</div><div class="line">    <span class="attr">deploy</span>: fis.plugin(<span class="string">'local-deliver'</span>, &#123;</div><div class="line">        <span class="attr">to</span>: TEST_OUTPUT_PATH</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line"></div><div class="line"><span class="comment">// 配置正式打包 包含压缩代码 合图图压缩</span></div><div class="line">fis.media(<span class="string">'dist'</span>)</div><div class="line">  .match(<span class="string">'**'</span>, &#123;</div><div class="line">    <span class="attr">relative</span>: <span class="literal">true</span></div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.&#123;js,css,scss,png,jpg,jpeg,gif,mp3,mp4,flv,swf,svg,eot,ttf,woff&#125;'</span>,&#123;</div><div class="line">      <span class="attr">useHash</span>: FORMAL_USE_HASH</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**.js'</span>,&#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'uglify-js'</span>,&#123;</div><div class="line">      <span class="attr">output</span> : &#123;</div><div class="line">        <span class="attr">ascii_only</span> : <span class="literal">true</span></div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**.html:js'</span>,&#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'uglify-js'</span>)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.png'</span>, &#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'png-compressor'</span>)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.&#123;css,scss&#125;'</span>,&#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'clean-css'</span>)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**html:css'</span>,&#123;</div><div class="line">    <span class="attr">optimizer</span>: fis.plugin(<span class="string">'clean-css'</span>)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'*.&#123;css,scss&#125;'</span>,&#123;</div><div class="line">    <span class="attr">useSprite</span> : <span class="literal">true</span></div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'::package'</span>, &#123;</div><div class="line">    <span class="attr">postpackager</span>: fis.plugin(<span class="string">'loader'</span>, &#123;</div><div class="line">      <span class="attr">allInOne</span>: &#123;</div><div class="line">        <span class="attr">js</span>: <span class="string">'j/auto_aio.js'</span>,</div><div class="line">        <span class="attr">css</span>: <span class="string">'c/auto_aio.css'</span></div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">  .match(<span class="string">'**'</span>, &#123;</div><div class="line">    <span class="attr">deploy</span>: fis.plugin(<span class="string">'local-deliver'</span>, &#123;</div><div class="line">      <span class="attr">to</span>: FORMAL_OUTPUT_PATH</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-开始使用"><a href="#5-开始使用" class="headerlink" title="5.开始使用"></a>5.开始使用</h3><p>将fis-conf.js拷到项目文件夹下。一般项目文件夹结构如下：<br>    文件目录结构如下：<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">└── 项目名称</div><div class="line">    ├── src</div><div class="line">    │    ├── h</div><div class="line">    │    ├── c</div><div class="line">    │    ├── j</div><div class="line">    │    ├── i</div><div class="line">    │    └── res</div><div class="line">    └── fis-conf.js</div></pre></td></tr></table></figure></p>
<h3 id="6-开发时开启浏览器自动同步刷新功能（类似browser-sync）"><a href="#6-开发时开启浏览器自动同步刷新功能（类似browser-sync）" class="headerlink" title="6. 开发时开启浏览器自动同步刷新功能（类似browser-sync）"></a>6. 开发时开启浏览器自动同步刷新功能（类似browser-sync）</h3><blockquote>
<p>a. 在命令行中进入到项目目录下。<br>b. 执行以下命令，然后浏览器会默认自动打开127.0.0.1:8080，若没有则要自行打开。<br>    <figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fis3 server <span class="built_in">start</span> -- <span class="built_in">type</span> node</div></pre></td></tr></table></figure></p>
<p>c. 命令行执行开启自动同步刷新功能<br>    <figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fis3 release -wL</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="7-编译测试包，当完成项目编码后，可以打测试包，放到线上测试环境中测试，测试包不会压缩代码、合并文件，以方便调试。"><a href="#7-编译测试包，当完成项目编码后，可以打测试包，放到线上测试环境中测试，测试包不会压缩代码、合并文件，以方便调试。" class="headerlink" title="7. 编译测试包，当完成项目编码后，可以打测试包，放到线上测试环境中测试，测试包不会压缩代码、合并文件，以方便调试。"></a>7. 编译测试包，当完成项目编码后，可以打测试包，放到线上测试环境中测试，测试包不会压缩代码、合并文件，以方便调试。</h3><blockquote>
<p>a. 在命令行中进入到项目目录下。<br>b. 命令行执行：<br>    <figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fis3 release test</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="8-编译正式包，当测试通过后，可以打正式包，此时就会压缩代码、合并文件。"><a href="#8-编译正式包，当测试通过后，可以打正式包，此时就会压缩代码、合并文件。" class="headerlink" title="8. 编译正式包，当测试通过后，可以打正式包，此时就会压缩代码、合并文件。"></a>8. 编译正式包，当测试通过后，可以打正式包，此时就会压缩代码、合并文件。</h3><blockquote>
<p>a. 在命令行中进入到项目目录下。<br>b. 命令行执行：<br>    <figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fis3 release dist</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="9-如果在线上遇到强缓存的情况，可以将配置文件中TEST-USE-HASH或FORMAL-USE-HASH置为true，开启文件指纹功能。"><a href="#9-如果在线上遇到强缓存的情况，可以将配置文件中TEST-USE-HASH或FORMAL-USE-HASH置为true，开启文件指纹功能。" class="headerlink" title="9.如果在线上遇到强缓存的情况，可以将配置文件中TEST_USE_HASH或FORMAL_USE_HASH置为true，开启文件指纹功能。"></a>9.如果在线上遇到强缓存的情况，可以将配置文件中TEST_USE_HASH或FORMAL_USE_HASH置为true，开启文件指纹功能。</h3><h3 id="10-使用rem自适应布局方案时，需要注意下面几点："><a href="#10-使用rem自适应布局方案时，需要注意下面几点：" class="headerlink" title="10.使用rem自适应布局方案时，需要注意下面几点："></a>10.使用rem自适应布局方案时，需要注意下面几点：</h3><blockquote>
<p>a. 编写css时，当遇到如1px边框，固定px大小的字体这种不需要使用rem自适应大小的属性时，在属性后面加<code>/*px*/</code>，详情参考<a href="https://github.com/songsiqi/px2rem" target="_blank" rel="external">https://github.com/songsiqi/px2rem</a><br>  <figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.selector</span> &#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">64px</span>; <span class="comment">/*px*/</span></div><div class="line">  <span class="attribute">font-size</span>: <span class="number">28px</span>; <span class="comment">/*px*/</span></div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>; <span class="comment">/*no*/</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> b. 请在CSS中加入默认字体大小：(竖屏情况下)<br>  <figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 默认是iphone6 */</span></div><div class="line"><span class="selector-tag">html</span>&#123; <span class="attribute">font-size</span>: <span class="number">50px</span>; &#125;</div><div class="line">@<span class="keyword">media</span> screen and (max-width:<span class="number">359px</span>) and (orientation:portrait) &#123;</div><div class="line">    <span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">46.667px</span>; &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/* 常见的安卓机 */</span></div><div class="line">@<span class="keyword">media</span> screen and (min-width:<span class="number">360px</span>) and (max-width:<span class="number">374px</span>) and (orientation:portrait) &#123;</div><div class="line">    <span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">48px</span>; &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/* 某些冷门的安卓机 如nexus4 */</span></div><div class="line">@<span class="keyword">media</span> screen and (min-width:<span class="number">384px</span>) and (max-width:<span class="number">399px</span>) and (orientation:portrait) &#123;</div><div class="line">    <span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">51.333px</span>; &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/* 某些冷门的安卓机 如nexus6 */</span></div><div class="line">@<span class="keyword">media</span> screen and (min-width:<span class="number">400px</span>) and (max-width:<span class="number">413px</span>) and (orientation:portrait) &#123;</div><div class="line">    <span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">53.333px</span>; &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/* iphone6 plus */</span></div><div class="line">@<span class="keyword">media</span> screen and (min-width:<span class="number">414px</span>) and (max-width:<span class="number">431px</span>) and (orientation:portrait)&#123;</div><div class="line">    <span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">55.2px</span>; &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/* 以下是其它设备 */</span></div><div class="line">@<span class="keyword">media</span> screen and (min-width:<span class="number">432px</span>) and (max-width:<span class="number">479px</span>) and (orientation:portrait)&#123;</div><div class="line">    <span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">57.6px</span>; &#125;</div><div class="line">&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width:<span class="number">480px</span>)and (max-width:<span class="number">639px</span>) and (orientation:portrait)&#123;</div><div class="line">   <span class="selector-tag">html</span>&#123; <span class="attribute">font-size</span>: <span class="number">64px</span>;&#125;</div><div class="line">&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width:<span class="number">640px</span>) and (orientation:portrait)&#123;</div><div class="line">   <span class="selector-tag">html</span>&#123; <span class="attribute">font-size</span>: <span class="number">85.333px</span>;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>c. viewport通常设置为1即可。<br>  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>d.动态适配rem的值<br> (1) 若项目页面带滚动条，只需要根据宽度进行自适应的：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">_initRem</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> pxUnit = <span class="number">100</span>;     <span class="comment">// 在px2rem中预设rem的值 即 1rem = ? px</span></div><div class="line">  <span class="keyword">var</span> designWid = <span class="number">750</span>;  <span class="comment">// 设计稿宽度</span></div><div class="line">  <span class="keyword">var</span> winWid = <span class="built_in">document</span>.body.clientWidth;</div><div class="line">  <span class="keyword">var</span> winHei = <span class="built_in">document</span>.body.clientHeight;</div><div class="line">  <span class="keyword">var</span> bl = winWid / designWid;</div><div class="line">  <span class="built_in">document</span>.querySelector(<span class="string">'html'</span>).style.fontSize = (bl * pxUnit) + <span class="string">'px'</span>;</div><div class="line">&#125;</div><div class="line">_initRem();</div></pre></td></tr></table></figure></p>
<p> (2) 若项目是单屏页面，吴滚动条时，还需要根据屏幕的宽高比例进行自适应：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">_initRem</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> pxUnit = <span class="number">100</span>;     <span class="comment">// 在px2rem中预设rem的值 即 1rem = ? px</span></div><div class="line">  <span class="keyword">var</span> designWid = <span class="number">750</span>;  <span class="comment">// 设计稿宽度</span></div><div class="line">  <span class="keyword">var</span> designHei = <span class="number">1206</span>; <span class="comment">// 设计稿高度</span></div><div class="line">  <span class="keyword">var</span> winWid = <span class="built_in">document</span>.body.clientWidth;</div><div class="line">  <span class="keyword">var</span> winHei = <span class="built_in">document</span>.body.clientHeight;</div><div class="line">  <span class="keyword">var</span> bl = winHei / winWid &lt; (designHei / designWid) ? winHei / designHei : winWid / designWid;</div><div class="line">  <span class="built_in">document</span>.querySelector(<span class="string">'html'</span>).style.fontSize = (bl * pxUnit) + <span class="string">'px'</span>;</div><div class="line">&#125;</div><div class="line">_initRem();</div></pre></td></tr></table></figure></p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2016/09/29/20160929_tsSubPub/" class="prev">PREV</a><a href="/2016/02/23/20160223_wechatVideo/" class="next">NEXT</a></div><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script><script>var cloudTieConfig = {
    url: document.location.href,
    sourceId: "",
    productKey: "73fc09c4a9074b41b145fb564eada364",
    target: "cloud-tie-wrapper"
};
var yunManualLoad = true;
Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);</script><div class="copyright"><p>© 2015 - 2017 <a href="http://shiwah.me">石华</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>